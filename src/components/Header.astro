---
import { t, getAlternateLocale, getLocalizedPath, type Locale } from '../i18n/utils';

interface Props {
  locale: Locale;
}

const { locale } = Astro.props;
const ui = t(locale);
const altLocale = getAlternateLocale(locale);
const base = import.meta.env.BASE_URL.replace(/\/$/, '');
// Strip base and locale prefix to get the page-relative path
const pathWithoutBase = Astro.url.pathname.replace(base, '');
const currentPath = pathWithoutBase.replace(`/${locale}`, '') || '/';
const altPath = getLocalizedPath(currentPath, altLocale);
---

<header class="sticky top-0 z-50 bg-warm-50/95 backdrop-blur-sm border-b border-warm-200/80">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 py-3 sm:py-4 flex items-center justify-between">
    <!-- Logo -->
    <a href={getLocalizedPath('/', locale)} class="shrink-0 group">
      <img
        src={`${base}/logo/logo-256.png`}
        alt="ColorEat Cafe"
        class="h-9 sm:h-10 w-auto group-hover:opacity-85 transition-opacity"
        width="256"
        height="256"
      />
    </a>

    <!-- Navigation -->
    <nav class="flex items-center gap-2 sm:gap-4">
      <a
        href={getLocalizedPath('/', locale)}
        class="hidden sm:inline-flex px-3 py-2 text-sm font-medium text-warm-700 hover:text-brand-700 transition-colors relative after:absolute after:bottom-0 after:left-3 after:right-3 after:h-[1px] after:bg-brand-700 after:scale-x-0 hover:after:scale-x-100 after:transition-transform after:origin-left"
      >
        {ui.nav.home}
      </a>
      <a
        href={getLocalizedPath('/menu/', locale)}
        class="px-3 py-2 text-sm font-medium text-warm-700 hover:text-brand-700 active:text-brand-800 transition-colors relative after:absolute after:bottom-0 after:left-3 after:right-3 after:h-[1px] after:bg-brand-700 after:scale-x-0 hover:after:scale-x-100 after:transition-transform after:origin-left"
      >
        {ui.nav.menu}
      </a>
      <a
        href={altPath}
        class="px-2.5 py-1.5 text-xs font-semibold text-warm-700 border border-warm-300 rounded hover:bg-brand-50 hover:border-brand-700 hover:text-brand-700 active:bg-brand-100 transition-all"
        aria-label={`Switch to ${ui.language[altLocale]}`}
      >
        {altLocale === 'ua' ? 'UA' : 'EN'}
      </a>
    </nav>
  </div>
</header>
