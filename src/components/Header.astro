---
import { t, getAlternateLocale, getLocalizedPath, type Locale } from '../i18n/utils';

interface Props {
  locale: Locale;
}

const { locale } = Astro.props;
const ui = t(locale);
const altLocale = getAlternateLocale(locale);
const base = import.meta.env.BASE_URL.replace(/\/$/, '');
// Strip base and locale prefix to get the page-relative path
const pathWithoutBase = Astro.url.pathname.replace(base, '');
const currentPath = pathWithoutBase.replace(`/${locale}`, '') || '/';
const altPath = getLocalizedPath(currentPath, altLocale);
---

<header class="sticky top-0 z-50 bg-warm-50/95 backdrop-blur-sm border-b border-warm-200">
  <div class="max-w-5xl mx-auto px-3 sm:px-4 py-2.5 sm:py-3 flex items-center justify-between">
    <!-- Logo -->
    <a href={getLocalizedPath('/', locale)} class="shrink-0 group">
      <img
        src={`${base}/logo/logo-256.png`}
        alt="ColorEat Cafe"
        class="h-9 sm:h-10 w-auto group-hover:opacity-90 transition-opacity"
        width="256"
        height="256"
      />
    </a>

    <!-- Navigation -->
    <nav class="flex items-center gap-1 sm:gap-2">
      <a
        href={getLocalizedPath('/', locale)}
        class="hidden sm:inline-flex px-3 py-2 text-sm font-medium text-warm-800 hover:text-brand-700 hover:bg-brand-50 rounded-lg transition-colors"
      >
        {ui.nav.home}
      </a>
      <a
        href={getLocalizedPath('/menu/', locale)}
        class="px-3 py-2 text-sm font-medium text-warm-800 hover:text-brand-700 active:bg-brand-50 rounded-lg transition-colors"
      >
        {ui.nav.menu}
      </a>
      <a
        href={altPath}
        class="px-2.5 sm:px-3 py-1.5 text-xs font-semibold text-warm-800 border border-warm-300 rounded-full hover:bg-brand-50 hover:border-brand-400 active:bg-brand-100 transition-colors"
        aria-label={`Switch to ${ui.language[altLocale]}`}
      >
        {altLocale === 'ua' ? 'UA' : 'EN'}
      </a>
    </nav>
  </div>
</header>
