---
import MenuItem from './MenuItem.astro';
import { l, type Locale } from '../i18n/utils';

interface Variant {
  label: { en: string; ua: string };
  price: number;
}

interface MenuItemType {
  id: string;
  name: { en: string; ua: string };
  description: { en: string; ua: string };
  price?: number;
  variants?: Variant[];
  note?: { en: string; ua: string };
  dietary: string[];
}

interface Category {
  id: string;
  title: { en: string; ua: string };
  note?: { en: string; ua: string };
  items: MenuItemType[];
}

interface Featured {
  id: string;
  name: { en: string; ua: string };
  subtitle?: { en: string; ua: string };
  description: { en: string; ua: string };
  price: number;
}

interface Props {
  menuTitle: { en: string; ua: string };
  categories: Category[];
  locale: Locale;
  menuId: string;
  featured?: Featured;
}

const { menuTitle, categories, locale, menuId, featured } = Astro.props;
---

<section id={menuId} class="scroll-mt-20 reveal">
  <!-- Section header with decorative divider -->
  <div class="mb-6">
    <div class="section-divider">
      <span class="section-divider-icon">&#9670;</span>
    </div>
    <h2 class="text-2xl sm:text-3xl font-bold font-[Playfair_Display] text-brand-800 text-center">
      {l(menuTitle, locale)}
    </h2>
    <div class="mt-3 mx-auto w-16 h-1 bg-gradient-to-r from-brand-400 via-brand-500 to-brand-400 rounded-full"></div>
  </div>

  {/* Featured item (e.g., tasting set) */}
  {featured && (
    <div class="mb-8 bg-gradient-to-br from-brand-50 to-warm-50 border border-brand-200 rounded-2xl p-5 sm:p-6 text-center">
      <span class="inline-block text-xs font-semibold uppercase tracking-widest text-brand-600 mb-2">
        {featured.subtitle ? l(featured.subtitle, locale) : 'â˜…'}
      </span>
      <h3 class="text-xl sm:text-2xl font-bold font-[Playfair_Display] text-brand-800 mb-2">
        {l(featured.name, locale)}
      </h3>
      <p class="text-sm text-warm-600 mb-3 max-w-lg mx-auto leading-relaxed">
        {l(featured.description, locale)}
      </p>
      <span class="inline-block text-2xl font-bold text-brand-700">${featured.price.toFixed(0)}</span>
    </div>
  )}

  {categories.map((category) => (
    <div class="mb-8 last:mb-0" id={category.id}>
      {categories.length > 1 && (
        <div class="mb-3 pb-2 border-b border-warm-200">
          <h3 class="text-lg font-semibold text-warm-700 flex items-center gap-2">
            <span class="w-1.5 h-1.5 rounded-full bg-brand-500 shrink-0"></span>
            {l(category.title, locale)}
          </h3>
          {category.note && (
            <p class="text-xs text-warm-500 italic mt-1 ml-3.5">{l(category.note, locale)}</p>
          )}
        </div>
      )}
      <div class="divide-y divide-warm-100">
        {category.items.map((item) => (
          <MenuItem item={item} locale={locale} />
        ))}
      </div>
    </div>
  ))}
</section>
