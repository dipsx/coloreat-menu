---
import MenuItem from './MenuItem.astro';
import { l, type Locale } from '../i18n/utils';

interface Variant {
  label: { en: string; ua: string };
  price: number;
}

interface MenuItemType {
  id: string;
  name: { en: string; ua: string };
  description: { en: string; ua: string };
  price?: number;
  variants?: Variant[];
  note?: { en: string; ua: string };
  dietary: string[];
}

interface Category {
  id: string;
  title: { en: string; ua: string };
  note?: { en: string; ua: string };
  items: MenuItemType[];
}

interface Featured {
  id: string;
  name: { en: string; ua: string };
  subtitle?: { en: string; ua: string };
  description: { en: string; ua: string };
  price: number;
}

interface Props {
  menuTitle: { en: string; ua: string };
  categories: Category[];
  locale: Locale;
  menuId: string;
  featured?: Featured;
}

const { menuTitle, categories, locale, menuId, featured } = Astro.props;
---

<section id={menuId} class="scroll-mt-24 sm:scroll-mt-28 reveal">
  <!-- Section header — serif font matching PDF -->
  <div class="mb-8">
    <div class="ornate-divider">
      <span class="text-gold-400 text-sm">&#9670;</span>
    </div>
    <h2 class="text-2xl sm:text-3xl font-serif font-semibold text-brand-700 text-center tracking-[0.05em]">
      {l(menuTitle, locale)}
    </h2>
    <div class="ornate-divider">
      <span class="text-gold-400 text-sm">&#9670;</span>
    </div>
  </div>

  {/* Featured item — "Discover Ukrainian Flavours" style from PDF */}
  {featured && (
    <div class="mb-10 bg-white border-[3px] border-double border-brand-700 rounded-lg p-6 sm:p-8 text-center relative">
      <!-- Corner ornaments matching PDF -->
      <div class="absolute top-3 left-3 w-5 h-5 border-t-[2px] border-l-[2px] border-gold-400 rounded-tl-sm"></div>
      <div class="absolute top-3 right-3 w-5 h-5 border-t-[2px] border-r-[2px] border-gold-400 rounded-tr-sm"></div>
      <div class="absolute bottom-3 left-3 w-5 h-5 border-b-[2px] border-l-[2px] border-gold-400 rounded-bl-sm"></div>
      <div class="absolute bottom-3 right-3 w-5 h-5 border-b-[2px] border-r-[2px] border-gold-400 rounded-br-sm"></div>

      <h3 class="text-2xl sm:text-3xl font-serif font-semibold text-brand-700 mb-1 tracking-wide">
        {l(featured.name, locale)}
      </h3>
      {featured.subtitle && (
        <span class="inline-block text-xs font-medium uppercase tracking-widest text-warm-500 mb-3">
          {l(featured.subtitle, locale)}
        </span>
      )}
      <p class="text-sm text-warm-600 mb-4 max-w-md mx-auto leading-relaxed italic">
        {l(featured.description, locale)}
      </p>
      <span class="inline-block text-2xl font-display font-bold text-brand-700 tracking-[0.02em]">${featured.price.toFixed(0)}</span>
    </div>
  )}

  {categories.map((category) => (
    <div class="mb-8 last:mb-0" id={category.id}>
      {categories.length > 1 && (
        <div class="mb-4 pb-2 border-b border-warm-200">
          <h3 class="text-lg font-serif font-semibold text-brand-700 tracking-[0.03em]">
            {l(category.title, locale)}
          </h3>
          {category.note && (
            <p class="text-xs text-warm-500 italic mt-1">{l(category.note, locale)}</p>
          )}
        </div>
      )}
      <div class="divide-y divide-warm-100">
        {category.items.map((item) => (
          <MenuItem item={item} locale={locale} />
        ))}
      </div>
    </div>
  ))}
</section>
